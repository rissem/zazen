doctype html
html(lang="en")
  head
    title=filepath
    meta(charset="utf-8")

    link(rel="stylesheet", href="/code-mirror/lib/codemirror.css")
    link(rel="stylesheet", href="/code-mirror/addon/display/fullscreen.css")
    link(rel="stylesheet", href="/code-mirror/theme/night.css")

    link(rel="stylesheet", href="/public/style.css")

    script(src="/code-mirror/lib/codeMirror.js")
    script(src="/code-mirror/mode/javascript/javascript.js")
    script(src="/code-mirror/mode/jade/jade.js")
    script(src="/code-mirror/mode/meta.js")
    script(src="/code-mirror/addon/display/fullscreen.js")
    script(src="/code-mirror/mode/meta.js")
    script(src="/public/jquery-2.1.3.min.js")

    script.
      $(document.body).ready(function(){
        codeMirror = CodeMirror(document.getElementById('firepad'), { lineWrapping: true, fullScreen:true, mode:CodeMirror.findModeByFileName("#{filepath}").mode, theme:"night", value: $("#fileContents").val()});

        $("#save").click(function(){
          var result = $.post(document.location.href, {fileData:codeMirror.getValue()}).
          done(function(data){
          //TODO mark as saved in client somehow
          })
        })

      })
  body
    h1 Jade - node template engine
    button#save="Save"
    #container.col
    textarea#fileContents(style="display:none")=file
    div#firepad(style="margin:8px")
